# 需求文件

## 簡介

人事薪資系統是一個全端應用程式，旨在自動化和簡化員工薪資管理流程。系統提供薪資通知、銀行轉帳檔案產生、Active Directory 帳號整合以及員工薪資查詢功能。

**技術架構：**
- 後端：.NET Core 8（跨平台支援）
- 前端：Vue 3
- 資料庫：MS SQL Server（支援 Linux 版本或透過網路連接）
- 部署環境：Linux Docker 容器
- AD 整合：透過 LDAP 協定

系統設計為容器化應用程式，所有元件均可在 Linux Docker 環境中運行。後端 API 使用 .NET Core 8 的跨平台特性，資料庫連線使用標準的 SQL Server 驅動程式，AD 整合透過 LDAP 協定實現跨平台身份驗證。系統架構採用鬆耦合設計，保留未來遷移至雲端平台（如 Azure、AWS）的彈性，但初期版本專注於本地 Docker 部署。

## 術語表

- **薪資系統 (Payroll System)**：管理員工薪資計算、通知和支付的完整系統
- **薪資通知服務 (Salary Notification Service)**：負責向員工發送薪資相關通知的子系統
- **加密附件 (Encrypted Attachment)**：使用密碼保護的電子郵件附件，用於傳送敏感薪資資料
- **轉帳檔案產生器 (Transfer File Generator)**：產生符合銀行格式的轉帳檔案的元件
- **AD 整合服務 (AD Integration Service)**：與 Active Directory 同步和驗證使用者帳號的服務
- **LDAP (Lightweight Directory Access Protocol)**：輕量級目錄存取協定，用於跨平台存取 Active Directory
- **Docker 容器 (Docker Container)**：輕量級、可移植的應用程式執行環境
- **環境變數 (Environment Variable)**：在容器中配置應用程式的動態參數
- **薪資查詢介面 (Salary Query Interface)**：允許員工查看其薪資資訊的使用者介面
- **員工 (Employee)**：系統中的使用者，可查詢自己的薪資資訊

- **管理員 (Administrator)**：具有完整系統存取權限的使用者，可管理所有薪資資料
- **薪資記錄 (Salary Record)**：包含員工特定期間薪資詳細資訊的資料實體
- **轉帳批次 (Transfer Batch)**：一組待處理的銀行轉帳交易
- **AD 使用者 (AD User)**：Active Directory 中的使用者帳號
- **請假記錄 (Leave Record)**：記錄員工請假的資料實體，包含請假類型、日期和天數
- **代理請假 (Proxy Leave Request)**：由他人代為提交的請假申請，需經被代理員工確認
- **事假 (Personal Leave)**：無薪假，需從薪資中扣除相應金額
- **病假 (Sick Leave)**：因病請假，根據公司政策可能部分或全額給薪
- **特休/年假 (Annual Leave)**：有薪假期，不影響薪資計算
- **出勤記錄 (Attendance Record)**：員工的工作日、請假和缺勤的完整記錄
- **費率表 (Rate Table)**：包含勞保、健保等法定扣除項目費率的資料表
- **勞保 (Labor Insurance)**：台灣勞工保險，依薪資級距和費率計算
- **健保 (Health Insurance)**：台灣全民健康保險，依投保金額和費率計算
- **費率版本 (Rate Version)**：特定生效期間的費率表版本，用於歷史薪資計算的追溯
- **薪資項目 (Salary Item)**：影響薪資計算的項目，可為加項或減項
- **加項 (Addition Item)**：增加薪資總額的項目，如加班費、津貼、獎金等
- **減項 (Deduction Item)**：減少薪資總額的項目，如代收代付、罰款等
- **加班費 (Overtime Pay)**：員工加班工作所獲得的額外報酬
- **代收代付 (Collection and Payment)**：公司代為收取或支付的款項，如員工餐費、停車費等
- **部門 (Department)**：組織內的功能性單位，用於員工分類和管理
- **組織階層 (Organization Hierarchy)**：部門之間的上下級關係結構
- **角色 (Role)**：定義使用者在系統中的權限集合
- **權限 (Permission)**：使用者可執行的特定操作或存取的資源
- **資料存取範圍 (Data Access Scope)**：定義使用者可查看和操作的資料範圍，如僅自己、本部門或全公司
- **系統參數 (System Parameter)**：控制系統行為的可配置設定值
- **工作日曆 (Work Calendar)**：定義工作日、休息日和國定假日的日曆
- **異常警示 (Anomaly Alert)**：系統偵測到異常情況時發出的通知
- **所得稅 (Income Tax)**：依法應從薪資中扣繳的稅款
- **扣繳憑單 (Withholding Statement)**：證明已扣繳所得稅的正式文件
- **累進稅率 (Progressive Tax Rate)**：依所得級距適用不同稅率的計算方式
- **年度結算 (Year-End Closing)**：年度結束時進行的薪資統計和資料封存作業
- **年度報表 (Annual Report)**：彙整全年度薪資資料的統計報表

## 需求

### 需求 1：薪資通知系統

**使用者故事：** 作為管理員，我希望系統能自動發送薪資通知給員工，以便員工及時了解其薪資資訊。

#### 驗收標準

1. WHEN 管理員觸發薪資通知流程 THEN 薪資通知服務 SHALL 向所有符合條件的員工發送通知
2. WHEN 薪資記錄被建立或更新 THEN 薪資通知服務 SHALL 在 24 小時內發送通知給相關員工
3. WHEN 通知發送失敗 THEN 薪資通知服務 SHALL 記錄錯誤並重試最多 3 次
4. WHEN 員工收到通知 THEN 通知內容 SHALL 包含薪資期間、總金額和發放日期
5. WHERE 員工已設定電子郵件偏好 THEN 薪資通知服務 SHALL 透過電子郵件發送通知
6. WHEN 電子郵件包含薪資明細附件 THEN 薪資通知服務 SHALL 使用密碼加密該附件
7. WHEN 產生加密附件 THEN 薪資通知服務 SHALL 使用員工身份證字號或員工編號作為解密密碼
8. WHEN 發送包含附件的通知 THEN 薪資通知服務 SHALL 在郵件內容中說明附件解密方式

### 需求 2：銀行轉帳檔案產生

**使用者故事：** 作為管理員，我希望系統能產生符合銀行格式的轉帳檔案，以便批次處理員工薪資支付。

#### 驗收標準

1. WHEN 管理員請求產生轉帳檔案 THEN 轉帳檔案產生器 SHALL 建立包含所有待支付薪資記錄的檔案
2. WHEN 產生轉帳檔案 THEN 轉帳檔案產生器 SHALL 驗證所有員工銀行帳號格式的正確性
3. WHEN 轉帳檔案被產生 THEN 轉帳檔案產生器 SHALL 使用銀行指定的檔案格式和編碼（通常為 Big5 或 UTF-8）
4. WHEN 儲存轉帳檔案 THEN 轉帳檔案產生器 SHALL 使用跨平台相容的檔案路徑和命名規則
5. WHEN 轉帳檔案包含無效資料 THEN 轉帳檔案產生器 SHALL 拒絕產生並回報具體錯誤
6. WHEN 轉帳檔案成功產生 THEN 轉帳檔案產生器 SHALL 記錄檔案產生時間和包含的交易數量

### 需求 3：AD 帳號整合

**使用者故事：** 作為系統管理員，我希望系統能與 Active Directory 整合，以便使用現有的企業帳號進行身份驗證和授權。

#### 驗收標準

1. WHEN 使用者嘗試登入 THEN AD 整合服務 SHALL 透過 LDAP 協定驗證使用者的 AD 憑證
2. WHEN 系統部署於 Linux Docker 環境 THEN AD 整合服務 SHALL 使用跨平台的 LDAP 函式庫連接 AD 伺服器
3. WHEN AD 使用者首次登入 THEN AD 整合服務 SHALL 在薪資系統中建立對應的員工記錄
4. WHEN AD 使用者資訊更新 THEN AD 整合服務 SHALL 在 1 小時內同步更新薪資系統中的員工資訊
5. WHEN AD 使用者被停用 THEN AD 整合服務 SHALL 立即撤銷該使用者對薪資系統的存取權限
6. WHEN 驗證 AD 使用者 THEN AD 整合服務 SHALL 從 AD 取得使用者的角色和權限資訊
7. WHEN AD 連線失敗 THEN AD 整合服務 SHALL 記錄錯誤並回傳明確的錯誤訊息給使用者

### 需求 4：員工薪資查詢介面

**使用者故事：** 作為員工，我希望能透過網頁介面查詢我的薪資資訊，以便隨時了解我的薪資歷史和明細。

#### 驗收標準

1. WHEN 員工登入系統 THEN 薪資查詢介面 SHALL 顯示該員工最近 12 個月的薪資記錄
2. WHEN 員工選擇特定薪資記錄 THEN 薪資查詢介面 SHALL 顯示該記錄的詳細明細，包含基本薪資、津貼、扣除項和淨額
3. WHEN 員工請求查看其他員工的薪資 THEN 薪資查詢介面 SHALL 拒絕請求並記錄該嘗試
4. WHEN 員工篩選薪資記錄 THEN 薪資查詢介面 SHALL 支援按日期範圍和薪資類型進行篩選
5. WHEN 員工匯出薪資資料 THEN 薪資查詢介面 SHALL 產生 PDF 格式的薪資報表

### 需求 5：資料安全與存取控制

**使用者故事：** 作為系統管理員，我希望系統能保護敏感的薪資資料，以便符合資料保護法規和公司政策。

#### 驗收標準

1. WHEN 使用者存取薪資資料 THEN 薪資系統 SHALL 驗證使用者具有適當的權限
2. WHEN 薪資資料儲存於資料庫 THEN 薪資系統 SHALL 加密敏感欄位，包含銀行帳號和薪資金額
3. WHEN 使用者執行敏感操作 THEN 薪資系統 SHALL 記錄操作日誌，包含使用者、時間和操作類型
4. WHEN 偵測到未授權存取嘗試 THEN 薪資系統 SHALL 封鎖該請求並通知管理員
5. WHEN API 請求被接收 THEN 薪資系統 SHALL 驗證請求包含有效的身份驗證令牌

### 需求 6：部門與組織架構管理

**使用者故事：** 作為管理員，我希望系統能管理部門和組織架構，以便正確分類員工並支援按部門進行薪資管理。

#### 驗收標準

1. WHEN 建立部門資料 THEN 薪資系統 SHALL 記錄部門名稱、部門代碼和部門主管
2. WHEN 設定組織階層 THEN 薪資系統 SHALL 記錄部門之間的上下級關係
3. WHEN 更新部門資料 THEN 薪資系統 SHALL 驗證部門代碼唯一性並記錄變更歷史
4. WHEN 停用部門 THEN 薪資系統 SHALL 驗證該部門無在職員工後才允許停用
5. WHEN 查詢部門資料 THEN 薪資系統 SHALL 回傳部門的完整資訊，包含所屬員工數量和部門主管資訊
6. WHEN 員工調動部門 THEN 薪資系統 SHALL 更新員工的部門歸屬並記錄調動日期

### 需求 7：權限角色管理

**使用者故事：** 作為系統管理員，我希望系統能管理使用者角色和權限，以便控制不同使用者對系統功能的存取。

#### 驗收標準

1. WHEN 建立角色 THEN 薪資系統 SHALL 記錄角色名稱、角色代碼和角色描述
2. WHEN 設定角色權限 THEN 薪資系統 SHALL 允許管理員指定該角色可存取的功能模組（如員工管理、薪資計算、報表查詢、系統設定）
3. WHEN 設定資料存取範圍 THEN 薪資系統 SHALL 允許管理員指定該角色可存取的資料範圍（如僅自己、本部門、全公司）
4. WHEN 指派角色給使用者 THEN 薪資系統 SHALL 記錄使用者與角色的關聯關係和生效日期
5. WHEN 一般員工存取管理功能 THEN 薪資系統 SHALL 拒絕存取並記錄該嘗試
6. WHEN 使用者執行操作 THEN 薪資系統 SHALL 驗證使用者的角色是否具有執行該操作的權限
7. WHEN 使用者查詢資料 THEN 薪資系統 SHALL 根據使用者的資料存取範圍過濾查詢結果
8. WHEN 更新角色權限 THEN 薪資系統 SHALL 立即套用新權限至所有擁有該角色的使用者
9. WHEN 查詢使用者權限 THEN 薪資系統 SHALL 回傳該使用者所有角色的權限總和和資料存取範圍

### 需求 8：員工基本資料管理

**使用者故事：** 作為管理員，我希望系統能管理員工的基本資料，以便正確進行薪資計算和管理。

#### 驗收標準

1. WHEN 建立員工資料 THEN 薪資系統 SHALL 記錄員工姓名、員工編號、部門、職位和固定月薪金額
2. WHEN 更新員工資料 THEN 薪資系統 SHALL 驗證必填欄位完整性並記錄變更歷史
3. WHEN 員工離職 THEN 薪資系統 SHALL 更新員工狀態為離職並記錄離職日期
4. WHEN 查詢員工資料 THEN 薪資系統 SHALL 回傳員工的完整資料，包含銀行帳號資訊

### 需求 9：請假管理與出勤記錄

**使用者故事：** 作為管理員，我希望系統能記錄和管理員工的請假資料，以便正確計算薪資扣款。

#### 驗收標準

1. WHEN 員工提交請假申請 THEN 薪資系統 SHALL 記錄請假類型、起始日期、結束日期和天數
2. WHEN 記錄事假 THEN 薪資系統 SHALL 標記該請假為無薪假並計算應扣除的薪資比例
3. WHEN 記錄病假 THEN 薪資系統 SHALL 根據病假天數和公司政策判斷是否扣薪
4. WHEN 請假記錄被建立 THEN 薪資系統 SHALL 驗證請假日期不與現有請假記錄重疊
5. WHEN 使用者代理他人提交請假 THEN 薪資系統 SHALL 發送通知給被代理員工並要求確認
6. WHEN 被代理員工確認請假 THEN 薪資系統 SHALL 正式建立請假記錄並記錄代理人資訊
7. WHEN 被代理員工拒絕請假 THEN 薪資系統 SHALL 取消該請假申請並通知代理人
8. WHEN 查詢員工出勤記錄 THEN 薪資系統 SHALL 回傳該員工指定期間的所有請假記錄和剩餘假期額度
9. WHERE 請假類型為特休或年假 THEN 薪資系統 SHALL 不扣除薪資並更新剩餘假期額度

### 需求 10：薪資項目管理

**使用者故事：** 作為管理員，我希望系統能管理各種薪資項目，以便靈活處理加班費、津貼、代收代付等項目。

#### 驗收標準

1. WHEN 建立薪資項目 THEN 薪資系統 SHALL 記錄項目名稱、項目代碼、項目類型（加項或減項）和計算方式
2. WHEN 薪資項目類型為加項 THEN 薪資系統 SHALL 在計算薪資時將該項目金額加入總額
3. WHEN 薪資項目類型為減項 THEN 薪資系統 SHALL 在計算薪資時將該項目金額從總額扣除
4. WHEN 設定加班費項目 THEN 薪資系統 SHALL 支援按小時數和加班費率計算金額
5. WHEN 設定代收代付項目 THEN 薪資系統 SHALL 允許輸入固定金額或按比例計算
6. WHEN 更新薪資項目 THEN 薪資系統 SHALL 保留項目變更歷史並記錄生效日期
7. WHEN 停用薪資項目 THEN 薪資系統 SHALL 標記項目為停用狀態並在新薪資計算中排除該項目

### 需求 11：勞健保費率管理

**使用者故事：** 作為管理員，我希望系統能管理和更新勞健保費率，以便確保薪資計算使用最新的法定費率。

#### 驗收標準

1. WHEN 管理員手動輸入新費率 THEN 薪資系統 SHALL 驗證費率格式並儲存為新版本的費率表
2. WHEN 管理員上傳費率檔案 THEN 薪資系統 SHALL 解析檔案內容並更新費率表資料
3. WHERE 系統整合政府 API THEN 薪資系統 SHALL 定期從 API 取得最新費率並自動更新
4. WHEN 費率表被更新 THEN 薪資系統 SHALL 記錄更新時間、來源和生效日期
5. WHEN 計算薪資 THEN 薪資系統 SHALL 使用薪資期間生效日期對應的費率版本
6. WHEN 查詢費率歷史 THEN 薪資系統 SHALL 回傳所有歷史費率版本和其生效期間

### 需求 12：薪資計算與處理

**使用者故事：** 作為管理員，我希望系統能準確計算員工薪資，以便確保支付的正確性。

#### 驗收標準

1. WHEN 開始計算當月薪資 THEN 薪資系統 SHALL 載入該員工上個月的薪資記錄作為參考資料
2. WHEN 計算員工薪資 THEN 薪資系統 SHALL 使用固定月薪作為基礎，並根據實際出勤天數比例計算
3. WHEN 員工有事假記錄 THEN 薪資系統 SHALL 按事假天數占當月工作日比例扣除薪資
4. WHEN 員工有病假記錄 THEN 薪資系統 SHALL 根據病假政策計算應扣除或保留的薪資金額
5. WHEN 員工有加班記錄 THEN 薪資系統 SHALL 根據加班費項目設定計算加班費並加入薪資總額
6. WHEN 員工有適用的薪資加項 THEN 薪資系統 SHALL 將所有加項金額累加至薪資總額
7. WHEN 員工有適用的薪資減項 THEN 薪資系統 SHALL 將所有減項金額從薪資總額扣除
8. WHEN 管理員選擇帶入上月資料 THEN 薪資系統 SHALL 複製上個月的薪資項目（加項和減項）至當月薪資計算
9. WHEN 計算勞健保扣除額 THEN 薪資系統 SHALL 使用當期生效的費率表計算員工和雇主應負擔的金額
10. WHEN 計算薪資扣除項 THEN 薪資系統 SHALL 套用所得稅、勞保、健保、請假扣款、代收代付項目和其他法定扣除
11. WHEN 薪資計算完成 THEN 薪資系統 SHALL 產生包含所有計算明細的薪資記錄，包含基本薪資、各項加項、各項減項、扣款明細和使用的費率版本
12. WHEN 薪資資料被修改 THEN 薪資系統 SHALL 保留修改歷史記錄，包含修改前後的值
13. WHEN 計算過程發生錯誤 THEN 薪資系統 SHALL 回滾交易並通知管理員

### 需求 13：系統設定與參數管理

**使用者故事：** 作為系統管理員，我希望系統能管理各種系統參數和設定，以便根據公司政策調整系統行為。

#### 驗收標準

1. WHEN 管理員設定公司基本資料 THEN 薪資系統 SHALL 記錄公司名稱、統一編號、地址和聯絡資訊
2. WHEN 管理員設定工作日曆 THEN 薪資系統 SHALL 記錄國定假日、公司假日和工作日定義
3. WHEN 管理員設定每月工作天數 THEN 薪資系統 SHALL 記錄預設工作天數（如 22 天）用於月薪計算
4. WHEN 管理員設定加班費率 THEN 薪資系統 SHALL 記錄平日加班、假日加班和國定假日加班的費率倍數
5. WHEN 管理員設定請假扣款規則 THEN 薪資系統 SHALL 記錄各類請假的扣款計算方式和扣款比例
6. WHEN 管理員設定病假給薪政策 THEN 薪資系統 SHALL 記錄病假天數門檻和對應的給薪比例
7. WHEN 管理員設定通知參數 THEN 薪資系統 SHALL 記錄電子郵件伺服器設定、發送時間和通知範本
8. WHEN 管理員設定附件加密參數 THEN 薪資系統 SHALL 記錄加密方式和密碼產生規則
9. WHEN 管理員更新系統參數 THEN 薪資系統 SHALL 驗證參數格式並記錄變更歷史和生效日期
10. WHEN 計算薪資 THEN 薪資系統 SHALL 使用當期生效的系統參數進行計算
11. WHEN 查詢系統參數歷史 THEN 薪資系統 SHALL 回傳所有歷史參數版本和其生效期間

### 需求 14：系統整合與 API

**使用者故事：** 作為開發人員，我希望系統提供清晰的 API 介面，以便前端和其他系統能順利整合。

#### 驗收標準

1. WHEN 前端請求薪資資料 THEN 薪資系統 SHALL 透過 RESTful API 回傳 JSON 格式的資料
2. WHEN API 請求包含無效參數 THEN 薪資系統 SHALL 回傳 HTTP 400 狀態碼和錯誤訊息
3. WHEN API 處理請求時發生伺服器錯誤 THEN 薪資系統 SHALL 回傳 HTTP 500 狀態碼並記錄錯誤詳情
4. WHEN API 回應資料 THEN 薪資系統 SHALL 在 2 秒內完成處理並回傳結果
5. WHERE API 端點需要身份驗證 THEN 薪資系統 SHALL 要求有效的 JWT 令牌

### 需求 15：部署與環境配置

**使用者故事：** 作為系統管理員，我希望系統能在 Linux Docker 環境中順利部署和運行，並保留未來遷移至雲端平台的彈性。

#### 驗收標準

1. WHEN 系統部署於 Linux Docker 容器 THEN 薪資系統 SHALL 使用跨平台相容的函式庫和元件
2. WHEN 後端應用程式啟動 THEN 薪資系統 SHALL 從環境變數或配置檔讀取資料庫連線字串和 AD 伺服器設定
3. WHEN 連接 MS SQL 資料庫 THEN 薪資系統 SHALL 使用標準的 SQL Server 驅動程式支援跨網路連線
4. WHEN 處理檔案路徑 THEN 薪資系統 SHALL 使用跨平台的路徑處理方式，避免 Windows 特定的路徑格式
5. WHEN 產生或讀取檔案 THEN 薪資系統 SHALL 使用 UTF-8 編碼確保跨平台的文字相容性
6. WHEN Docker 容器重啟 THEN 薪資系統 SHALL 自動重新連接資料庫和 AD 伺服器
7. WHEN 記錄系統日誌 THEN 薪資系統 SHALL 輸出至標準輸出，以便 Docker 日誌系統收集
8. WHEN 設計系統架構 THEN 薪資系統 SHALL 採用鬆耦合設計，以便未來可替換為雲端服務（如雲端儲存、雲端資料庫）

**未來擴展考量（本階段不實作）：**
- 支援雲端物件儲存服務（如 AWS S3、Azure Blob Storage）
- 支援雲端資料庫服務（如 Azure SQL Database、AWS RDS）
- 支援雲端容器編排服務（如 Kubernetes、Azure Container Instances）
- 支援雲端身份驗證服務整合

### 需求 16：報表與匯出功能

**使用者故事：** 作為管理員，我希望能產生各種薪資報表，以便進行分析和稽核。

#### 驗收標準

1. WHEN 管理員請求薪資總表 THEN 薪資系統 SHALL 產生包含所有員工指定期間薪資摘要的報表
2. WHEN 管理員匯出報表 THEN 薪資系統 SHALL 支援 PDF、Excel 和 CSV 格式
3. WHEN 產生報表 THEN 薪資系統 SHALL 包含報表產生時間和產生者資訊
4. WHEN 報表包含大量資料 THEN 薪資系統 SHALL 在 30 秒內完成報表產生
5. WHEN 管理員篩選報表資料 THEN 薪資系統 SHALL 支援按部門、日期範圍和員工狀態進行篩選

### 需求 17：異常處理與警示

**使用者故事：** 作為管理員，我希望系統能偵測和通知異常情況，以便及時處理潛在問題。

#### 驗收標準

1. WHEN 員工薪資金額與上月相比變動超過 30% THEN 薪資系統 SHALL 標記為異常並通知管理員
2. WHEN 偵測到重複的銀行帳號 THEN 薪資系統 SHALL 發出警示並要求管理員確認
3. WHEN 薪資計算結果為負數或零 THEN 薪資系統 SHALL 標記為異常並要求人工審核
4. WHEN 系統發生錯誤 THEN 薪資系統 SHALL 記錄完整的錯誤堆疊和上下文資訊
5. WHEN 產生異常警示 THEN 薪資系統 SHALL 透過系統通知和電子郵件通知相關管理員
6. WHEN 管理員查看異常記錄 THEN 薪資系統 SHALL 顯示所有未處理的異常和其詳細資訊

### 需求 18：所得稅計算與扣繳

**使用者故事：** 作為管理員，我希望系統能計算所得稅扣繳並產生扣繳憑單，以便符合稅務申報要求。

#### 驗收標準

1. WHEN 計算月薪資 THEN 薪資系統 SHALL 根據累進稅率表計算應扣繳的所得稅金額
2. WHEN 計算所得稅 THEN 薪資系統 SHALL 考慮員工的扣除額和免稅額設定
3. WHEN 年度結束 THEN 薪資系統 SHALL 計算每位員工的年度所得總額和已扣繳稅額
4. WHEN 產生扣繳憑單 THEN 薪資系統 SHALL 產生符合國稅局格式的扣繳憑單檔案
5. WHEN 產生扣繳憑單 THEN 薪資系統 SHALL 包含員工基本資料、年度所得總額、扣繳稅額和各項扣除額
6. WHEN 匯出年度申報資料 THEN 薪資系統 SHALL 產生符合國稅局電子申報格式的檔案
7. WHEN 查詢員工年度所得 THEN 薪資系統 SHALL 回傳該員工當年度所有薪資記錄和扣繳明細

### 需求 19：年度作業與結算

**使用者故事：** 作為管理員，我希望系統能處理年度結算作業，以便正確處理跨年度的薪資資料。

#### 驗收標準

1. WHEN 執行年度結算 THEN 薪資系統 SHALL 計算所有員工的年度薪資總額和各項扣除總額
2. WHEN 執行年度結算 THEN 薪資系統 SHALL 產生年度薪資總表報表，包含所有員工的年度統計資料
3. WHEN 執行年度結算 THEN 薪資系統 SHALL 重置年度相關的累計數據，如年假額度和累計所得
4. WHEN 跨年度查詢薪資 THEN 薪資系統 SHALL 支援跨年度的薪資記錄查詢和統計
5. WHEN 產生年度報表 THEN 薪資系統 SHALL 包含年度人事成本分析、部門薪資統計和趨勢分析
6. WHEN 年度結算完成 THEN 薪資系統 SHALL 封存上一年度的薪資資料並標記為已結算
7. WHEN 查詢已結算年度資料 THEN 薪資系統 SHALL 允許查詢但不允許修改已結算的薪資記錄
